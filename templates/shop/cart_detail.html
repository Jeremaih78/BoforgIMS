{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Your Cart | Boforg Shop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/htmx.org@1.9.12"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <header class="bg-white shadow-sm">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <a href="/shop/" class="text-lg font-semibold">Boforg Shop</a>
      <nav class="flex gap-5 text-sm font-medium">
        <a href="/" class="hover:text-blue-600">Home</a>
        <a href="/shop/" class="hover:text-blue-600">Shop</a>
        <a href="/shop/checkout/" class="text-blue-600">Checkout</a>
      </nav>
      <div class="flex items-center gap-2 text-sm text-gray-600">
        <span>Cart</span>
        {% include 'shop/partials/cart_counter.html' with count=cart_count %}
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-10">
    <h1 class="text-3xl font-bold">Shopping Cart</h1>
    <p class="mt-2 text-sm text-gray-600">Review your selections before checkout.</p>

    {% if items %}
    <div class="mt-8 grid md:grid-cols-[2fr_1fr] gap-8">
      <section class="space-y-4">
        {% for item in items %}
        <div class="bg-white border rounded-3xl shadow-sm p-4 flex gap-4">
          <div class="w-28 h-28 rounded-2xl overflow-hidden bg-gray-100">
            <img src="{{ item.product.get_primary_image_url }}" alt="{{ item.product.name }}" class="w-full h-full object-cover">
          </div>
          <div class="flex-1">
            <h2 class="text-lg font-semibold">{{ item.product.name }}</h2>
            <div class="text-sm text-gray-500">{{ item.product.sku }}</div>
            <div class="mt-2 text-blue-700 font-semibold">${{ item.product.price }}</div>
            <div class="mt-2 text-sm text-gray-600">Quantity: {{ item.quantity }}</div>
            <form hx-post="/shop/cart/remove/" hx-target="#cart-counter" hx-swap="outerHTML" class="mt-3 inline-flex">
              {% csrf_token %}
              <input type="hidden" name="product_id" value="{{ item.product.id }}">
              <button class="text-sm text-red-600 hover:underline">Remove</button>
            </form>
          </div>
          <div class="text-right text-lg font-semibold text-gray-900">${{ item.line_total }}</div>
        </div>
        {% endfor %}
      </section>

      <aside class="bg-white border rounded-3xl shadow-sm p-6">
        <h3 class="text-lg font-semibold">Order Summary</h3>
        <div class="mt-4 flex items-center justify-between text-sm text-gray-600">
          <span>Subtotal</span>
          <span>${{ subtotal }}</span>
        </div>
        <div class="mt-2 text-xs text-gray-500">Shipping & payment calculated at checkout.</div>
        <a href="/shop/checkout/" class="mt-6 block text-center bg-blue-600 text-white py-3 rounded-2xl font-semibold">Proceed to Checkout</a>
      </aside>
    </div>
    {% else %}
    <div class="mt-12 text-center text-gray-500">
      <p>Your cart is empty.</p>
      <a href="/shop/" class="mt-4 inline-flex px-5 py-3 bg-blue-600 text-white rounded-2xl">Continue Shopping</a>
    </div>
    {% endif %}
  </main>

  <footer class="border-t bg-white">
    <div class="max-w-6xl mx-auto px-4 py-10 text-sm text-gray-500 flex justify-between">
      <div>&copy; {% now "Y" %} Boforg Technologies Private Limited.</div>
      <div class="flex gap-4">
        <a class="hover:text-blue-600" href="/legal/privacy/">Privacy</a>
        <a class="hover:text-blue-600" href="/legal/terms/">Terms</a>
      </div>
    </div>
  </footer>
</body>
</html>
